

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Audit &mdash; reality.eth  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="reality.eth  documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> reality.eth
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dapp.html">Using the Reality.eth dapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contracts.html">Using Reality.eth from a contract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../availability.html">Unavailability and null responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arbitrators.html">Arbitrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fees.html">Fees and payments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whitepaper.html">White paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contract_explanation.html">Contract Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../audit.html">Audit</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">reality.eth</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Audit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/au/rcaudit/Audit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="audit">
<h1>Audit<a class="headerlink" href="#audit" title="Permalink to this headline">¶</a></h1>
<div class="section" id="first-pass">
<h2>First Pass<a class="headerlink" href="#first-pass" title="Permalink to this headline">¶</a></h2>
<div class="section" id="l413minorbondmustbezero-is-always-true">
<h3>L413MINORbondMustBeZero is always true<a class="headerlink" href="#l413minorbondmustbezero-is-always-true" title="Permalink to this headline">¶</a></h3>
<p>Because function is not payable, modifier has no functionality after Solidity introduced the payable restriction and could be eliminated.</p>
</div>
<div class="section" id="l478minorimprovement-clarify-current-winning-with-each-answer-given">
<h3>L478MINORImprovement: clarify current winning with each answer given<a class="headerlink" href="#l478minorimprovement-clarify-current-winning-with-each-answer-given" title="Permalink to this headline">¶</a></h3>
<p>Each answerer would bear a share of the gas costs, while herethe winner would cover the costs on the entire answer chain.</p>
<p><em>Edmund Edgar: This was our original design, it’s much simpler. However it became problematic when added commit-&gt;reveal. If there is an unrevealed previous answer, you don’t know whether the user who gave it needs to be paid, because you don’t yet know what their answer is. An alternative would be to lock the question until the reveal is either supplied or times out and prevents the next answer being added, but this allows users to lock the question at low cost (eg you can answer with a very low fee, then not reveal until the reveal deadline).</em></p>
</div>
</div>
<div class="section" id="second-pass">
<h2>Second Pass<a class="headerlink" href="#second-pass" title="Permalink to this headline">¶</a></h2>
<p>The workshop started at 9.00AM CET. with a general introduction of the Reality Check platform and testing out the interface.</p>
<div class="section" id="observation-1">
<h3>Observation 1<a class="headerlink" href="#observation-1" title="Permalink to this headline">¶</a></h3>
<p>OUT OF SCOPE. There was a problem with updating the answers in the interface automatically. Roland Kofler had to refresh the page on several occasions (Google Chrome).</p>
</div>
<div class="section" id="observation-2">
<h3>Observation 2<a class="headerlink" href="#observation-2" title="Permalink to this headline">¶</a></h3>
<p>OUT OF SCOPE. When posting a question there are no labels describing the dropdown, making it a guesswork for the inexperienced user. The choice of having the description within the dropdowns does not provide enough context.</p>
<p>Recommendation: holding a usability workshop
with a “Thinking Aloud” Protocol to uncover potential problems.</p>
<p><a class="reference internal" href="au/rcaudit/images/1000000000000186000002692DBCAC73287C06A4.png"><img alt="1000000000000186000002692DBCAC73287C06A4_png" src="au/rcaudit/images/1000000000000186000002692DBCAC73287C06A4.png" style="width: 1.5654in; height: 2.4744in;" /></a></p>
</div>
<div class="section" id="mediumspoofing-the-reality-check-contract">
<h3>MEDIUMSpoofing the reality check contract<a class="headerlink" href="#mediumspoofing-the-reality-check-contract" title="Permalink to this headline">¶</a></h3>
<p>The arbitrator contract is loosely coupled with
RealityCheck
, he always has the RealityCheck contract as a parameter. This provides flexibility but COULD bring inconsistencies.</p>
<p>The intent of an M:N dependency is to seamlessly transit from a reality check version to another.</p>
<p>The argument has been held that such an attack is only one of many manipulation attacks inherently possible in the Metamask/ Browser ecosystem. Because the other vulnerabilities are unresolved in such a setup, resolving this problem would still enable similar attacks.</p>
<p>Edmund Edgar: “So the attack vector is that, can we fool the arbitrator about the address of the RealityCheck contract. Maybe a bigger issue for fooling regular users, eg if you hack my dapp source code etherdelta-style you can make them think they’re interacting with the real contract when really it’s the attacker’s contract
Knowing which contract you’re dealing with is kind-of the central flaw in the whole metamask security model right now, along with the fact that the user can’t really realistically tell what message they’re signing…I think tricking the arbitrator feels like kind-of a milder case of that, in that they’re a specialist user with (hopefully) unusually good security”</p>
<p>If the ONLY possible use of the RealityCheck system is seen in the context of a Web-Dapp with current level of security this argument is valid.</p>
<p><strong>If there is a likely option that RealityCheck will be used in more automated (e.g. used by other contract systems or used with in IoT and secure hardware) a more robust approach to security is recommended. **
**This holds more true if RealityCheck should be part of a decentralized permissionless service ecosystem, many in the Ethereum community envision.</strong></p>
</div>
<div class="section" id="minorrealitycheckapi-defined-but-never-explicitly-implemented">
<h3>MINORRealityCheckAPI defined but never explicitly implemented<a class="headerlink" href="#minorrealitycheckapi-defined-but-never-explicitly-implemented" title="Permalink to this headline">¶</a></h3>
<p>Currently the realitycheck contract is called by casting an address to the
* abstract contract *
RealityCheckAPI
. The abstract contract is never inherited, apparently Solidity does not check strongly for Type-safety. Runtime-typing is not an official Solidity feature:</p>
<p>Solidity is a statically typed language, which means that the type of each variable (state and local) needs to be specified (or at least known - see Type Deduction below) at compile-time. Solidity provides several elementary types which can be combined to form complex types.</p>
<p><a class="reference external" href="https://solidity.readthedocs.io/en/v0.4.21/types.html">https://solidity.readthedocs.io/en/v0.4.21/types.html</a></p>
<p>A more conventional way would be to enforce the implementation by stating that</p>
<p>contract RealityKeys is RealityCheckAPI</p>
<p>Recommendable is also using the
interface
keyword.
<a class="reference external" href="https://solidity.readthedocs.io/en/v0.4.21/contracts.html#interfaces">https://solidity.readthedocs.io/en/v0.4.21/contracts.html#interfaces</a></p>
</div>
</div>
<div class="section" id="revision-after-feature-enhancement">
<h2>Revision after Feature Enhancement<a class="headerlink" href="#revision-after-feature-enhancement" title="Permalink to this headline">¶</a></h2>
<p>The following enhancement was made on the 24th Feb 2018:</p>
<p><a class="reference external" href="https://github.com/realitykeys/realitycheck/commit/207278cecb4a99709dd7e6c1b601196ba11e676e#diff-78b329f919a5d781dd13643896fd950b">https://github.com/realitykeys/realitycheck/commit/207278cecb4a99709dd7e6c1b601196ba11e676e#diff-78b329f919a5d781dd13643896fd950b</a></p>
<p>The change allows an arbitrator to retrieve funds from the RealityCheck contract that are conceived as an anti-spam measure.</p>
<p>The change consists in adding:</p>
<ol class="arabic simple">
<li>A
payable
fallback function to
Arbitrator.sol</li>
<li>Adding a
function
callWithdraw(address realitycheck) onlyOwner
which allows the Arbiter to withdraw from the
RealityCheck.sol
contract to the Arbitrator Contract.</li>
<li>Adding withdraw() to the
RealityCheckAPI
contract in
Arbitrator.sol</li>
</ol>
<p>The enhancement bears no additional vulnerabilities.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>There is a case for coupling Arbitrator and RealityCheck contract dependencies in a trustless way as one hopes RealityCheck will be used by the broader smart contract system as Oracle. It is left to the discretion and judgment of the RealityKeys team to pick this option.</p>
<p>Enforcing the implementation of RealityCheckAPI could also be recommended.</p>
</div>
<div class="section" id="revision-after-audit">
<h2>Revision after Audit<a class="headerlink" href="#revision-after-audit" title="Permalink to this headline">¶</a></h2>
<div class="section" id="eliminating-contract-realitycheckapi">
<h3>Eliminating contract RealityCheckAPI<a class="headerlink" href="#eliminating-contract-realitycheckapi" title="Permalink to this headline">¶</a></h3>
<p>The recommendation to explicitly inherit RealityCheckAPI was modified to directly reference the RealityCheck contract instead.</p>
<p><a class="reference external" href="https://github.com/realitykeys/realitycheck/commit/2fcd6f1746d7fcd25b79cf29e19f420d613fd84d">https://github.com/realitykeys/realitycheck/commit/2fcd6f1746d7fcd25b79cf29e19f420d613fd84d</a></p>
<p>Changes in
Arbitrator.sol
:</p>
<ol class="arabic simple">
<li>Contract
RealityCheckAPI
was removed</li>
<li>Casts to
RealityCheckAPI(realitycheck)
were replaced with
RealityCheck(realitycheck)</li>
</ol>
<p><strong>The change is not capable of introducing new vulnerabilities since the behavior of the contracts have not changed.</strong></p>
</div>
<div class="section" id="tying-arbitrator-to-a-single-reality-check-address">
<h3>Tying Arbitrator to a single Reality Check address<a class="headerlink" href="#tying-arbitrator-to-a-single-reality-check-address" title="Permalink to this headline">¶</a></h3>
<p>The recommendation of implementing a tighter coupling between Arbitrator and RealityCheck contracts were followed with the following commit:</p>
<p><a class="reference external" href="https://github.com/realitykeys/realitycheck/commit/a4068686b3edb7df5356b64ac29e9ff38952293e">https://github.com/realitykeys/realitycheck/commit/a4068686b3edb7df5356b64ac29e9ff38952293e</a></p>
<p>Changes in
Arbitrator.sol
:</p>
<ol class="arabic simple">
<li>A member variable
RealityCheck public realitycheck
was introduced</li>
<li>A setter function for this member variable was introduced:
function setRealityCheck(address addr) onlyOwner</li>
<li>A event logs the changes on this function
event LogSetRealityCheck</li>
<li>All parameters
address realitycheck
were removed from the function signatures</li>
<li>All casts to
RealityCheck(realitycheck)
were replaced by the member variable
realitycheck</li>
</ol>
<p>The change makes upgrades to new RealityCheck contracts explicit and part of the “trust architecture” of the contract. Besides setting the contract explicitly, no behavior has changed.
<strong>The modification is therefore not capable of introducing new vulnerabilities.</strong></p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, KK Social Minds.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>